---
title: "Cw2"
format: html
---

## Biblioteki używane w ćwiczenniu

```{r}
library(tidymodels) 
library(skimr) 
library(GGally) 
library(openair) 
tidymodels_prefer()
```

## Wczyatanie danych

```{r}
air <- mydata |> selectByDate(year = 2002)
air |> skim()
```

### Usuawanie brakujących danych

```{r}
air <- air |> na.omit()
```

### Korelacja pomiędzy tlenkami azotu, a dwutlenkiem azotu

```{r}
set.seed(222)
air[sample(1:nrow(air), size = 300, replace = F),] |> 
  select(nox, no2) |> 
  ggpairs()
```

```{r}
library(ggpubr)
# wykres regresji liniowej, do sprawdzenia danych 
set.seed(222)
air[sample(1:nrow(air), size = 300, replace = F),] |> 
  select(nox, no2) |> 
  ggplot(aes(nox, no2)) +
  geom_point() +
  geom_smooth(method = "lm", se = T, formula = y ~ x) + 
  stat_cor(label.x = 10, label.y = 80) + 
  stat_regline_equation(label.x = 10, label.y = 87) +
  theme_bw()
```

Dane wydają się mocno skorelowane.

Wykres stężenia ozonu w czasie.

```{r}
air |> 
  ggplot(aes(date, o3)) +
  geom_line()+
  theme_bw()
```

Przyjmujemy założenie, żę stępnie ozonu jest wysokie gdy przekracza 10 mikrogramów na metr sześcienny, a niskie jest poniżej tej wartości.

## Przetwarzanie danych

Użyto funckji `cut` do przekształcenia zmiennej ilościowej na jakościową.

```{r}
air |> 
  pull(o3) |> 
  range()
```
```{r}
air <- 
  air |> 
  mutate(ozone =cut(
    o3,
    breaks = c(-0.1, 10, 53),
    labels = c("Niskie", "Wysokie")
  ))
```

Check:
```{r}
air |> count(ozone)
```


